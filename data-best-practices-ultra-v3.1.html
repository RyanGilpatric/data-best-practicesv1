<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Data Best Practices — Interactive Guide (Ultra v3.1)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light">
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#0b1020; --bg-2:#0e1427; --panel:#0f172a; --glass: rgba(255,255,255,.06);
      --text:#e6e9f0; --muted:#9aa4b2; --brand:#60a5fa; --brand-2:#22d3ee; --accent:#22c55e; --danger:#ef4444; --amber:#f59e0b; --border:#1f2937;
      --shadow-lg: 0 30px 60px rgba(0,0,0,.35); --shadow-md: 0 10px 30px rgba(0,0,0,.25); --max: 1220px; }
    :root[data-theme='light']{ --bg:#f6f8fc; --bg-2:#eef2f7; --panel:#ffffff; --glass: rgba(10,10,10,.06); --text:#0e172a; --muted:#495569; --border:#e5e7eb; --shadow-lg:0 30px 60px rgba(2,6,23,.12); --shadow-md:0 10px 30px rgba(2,6,23,.10); }
    *{ box-sizing: border-box; } html, body{ height:100%; }
    body{ margin:0; color:var(--text); background:
      radial-gradient(1200px 800px at 10% -10%, rgba(34,211,238,.15), transparent 60%),
      radial-gradient(800px 600px at 110% 10%, rgba(96,165,250,.12), transparent 50%), var(--bg);
      font-family:'Inter',ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial; line-height:1.55; letter-spacing:.2px; overflow-y:overlay; }
    ::selection{ background: rgba(96,165,250,.35); } a{ color:inherit; text-decoration:none; }
    .shell{ min-height:100dvh; display:grid; grid-template-columns: 320px 1fr 340px; }
    .left{ position: sticky; top:0; height:100dvh; overflow:auto; background:linear-gradient(180deg,var(--panel),var(--bg-2)); border-right:1px solid var(--border); }
    .center{ min-width:0; display:flex; flex-direction:column; }
    .right{ position: sticky; top:0; height:100dvh; overflow:auto; border-left:1px solid var(--border); background:linear-gradient(180deg,var(--bg-2),transparent); }
    .container{ width:100%; max-width: var(--max); margin:0 auto; padding: 0 24px; }
    .brand{ display:flex; align-items:center; gap:12px; padding: 18px 18px 8px; } .brand h1{ font-size:18px; margin:0; font-weight:700; }
    .note{ color:var(--muted); font-size:12px; padding:0 18px 8px; }
    .search{ margin:8px 12px 14px; display:flex; align-items:center; gap:8px; background:var(--glass); border:1px solid var(--border); padding:10px 12px; border-radius:12px; box-shadow:var(--shadow-md); }
    .search input{ flex:1; background:transparent; border:0; color:var(--text); outline:none; }
    .navlink{ display:flex; align-items:center; gap:10px; padding:10px 14px; margin:2px 8px; border-radius:10px; border:1px solid transparent; color:var(--text); }
    .navlink:hover{ background: rgba(96,165,250,.10); } .navlink.active{ background: linear-gradient(180deg, rgba(96,165,250,.20), rgba(96,165,250,.10)); border-color: rgba(96,165,250,.25); box-shadow: inset 0 0 0 1px rgba(96,165,250,.25); }
    .section{ margin:12px 8px; border:1px solid var(--border); border-radius:14px; overflow:hidden; box-shadow:var(--shadow-md); }
    .section > button{ width:100%; text-align:left; background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,0)); border:0; color:var(--text); padding:12px 14px; display:flex; align-items:center; gap:10px; cursor:pointer; }
    .section > button:hover{ background: rgba(96,165,250,.08); }
    .subnav{ display:none; background:linear-gradient(180deg,var(--bg-2),transparent); }
    .subnav a{ display:block; padding:10px 40px; border-top:1px solid var(--border); color:var(--muted); }
    .subnav a:hover{ background: rgba(96,165,250,.08); color:var(--text); }
    .side-cta{ display:flex; gap:8px; padding:6px 12px 16px; }
    .btn{ display:inline-flex; align-items:center; gap:8px; background: rgba(96,165,250,.15); color:var(--text); border:1px solid var(--border); border-radius:10px; padding:8px 12px; cursor:pointer; }
    .btn.ghost{ background:transparent; }
    .kbd{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px; padding:1px 6px; border:1px solid var(--border); border-bottom-width:2px; border-radius:6px; background: rgba(255,255,255,.05); color:var(--muted); }
    .top{ position: sticky; top:0; z-index:10; backdrop-filter:saturate(140%) blur(8px); background: linear-gradient(180deg, rgba(2,6,23,.55), rgba(2,6,23,0)); border-bottom:1px solid var(--border); }
    .topbar{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:10px 20px; }
    .crumbs{ display:flex; align-items:center; gap:8px; color:var(--muted); font-size:12px; }
    .hero{ position:relative; padding:28px 0 10px; }
    .heroCard{ border:1px solid var(--border); background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); border-radius:18px; padding:18px; box-shadow:var(--shadow-lg); display:flex; align-items:center; gap:14px; }
    .heroIcon{ width:46px; height:46px; border-radius:12px; display:grid; place-items:center; background: radial-gradient(100% 100% at 0% 0%, rgba(34,211,238,.35), rgba(96,165,250,.15)); border:1px solid var(--border); }
    .hero h2{ margin:0; font-size: clamp(22px, 3.4vw, 34px); letter-spacing:.3px; }
    .hero p{ margin:4px 0 0; color:var(--muted); }
    .main{ padding:16px 0 56px; } .content{ display:grid; grid-template-columns:1fr; gap:18px; }
    .card{ background: linear-gradient(180deg, rgba(34,197,94,.10), rgba(2,6,23,.10)); border:1px solid var(--border); border-radius:14px; padding:16px; box-shadow:var(--shadow-md); }
    .callout{ border-left:4px solid var(--amber); padding:12px 14px; background: rgba(245,158,11,.08); border-radius:10px; }
    h3{ margin:18px 0 8px; color:var(--brand-2); letter-spacing:.04em; text-transform:uppercase; font-size:15px; }
    h4{ margin:12px 0 6px; font-size:15px; }
    ol, ul{ padding-left:18px; }
    .table{ width:100%; border-collapse:collapse; border:1px solid var(--border); }
    .table th, .table td{ border:1px solid var(--border); padding:8px 10px; text-align:left; }
    .muted{ color:var(--muted); } .ok{ color:var(--accent); } .danger{ color:var(--danger); } mark{ background:#fde68a; color:#1f2937; padding:0 2px; border-radius:3px; }
    .rail{ padding:16px; } .rail .panel{ border:1px solid var(--border); border-radius:14px; background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); padding:14px; margin-bottom:12px; box-shadow:var(--shadow-md); }
    .rail h5{ margin:0 0 10px; font-size:13px; text-transform:uppercase; letter-spacing:.06em; color:var(--brand-2); }
    .progress{ position:fixed; top:0; left:0; height:3px; background:linear-gradient(90deg,var(--brand),var(--brand-2)); width:0%; z-index:50; }
    .fab{ position:fixed; bottom:18px; right:18px; display:flex; gap:8px; z-index:40; } .fab .btn{ backdrop-filter: blur(6px); background: var(--glass); }
    .cmdk{ position:fixed; inset:0; display:none; place-items:center; backdrop-filter:blur(6px); background:rgba(2,6,23,.45); z-index:60; }
    .cmdk.open{ display:grid; }
    .cmd{ width:min(760px,calc(100% - 32px)); border:1px solid var(--border); border-radius:16px; overflow:hidden; background:var(--panel); box-shadow:var(--shadow-lg); }
    .cmdHead{ display:flex; align-items:center; gap:10px; padding:10px 12px; border-bottom:1px solid var(--border); background:var(--bg-2); }
    .cmdHead input{ flex:1; background:transparent; border:0; outline:none; color:var(--text); font-size:15px; }
    .cmdList{ max-height:50vh; overflow:auto; }
    .cmdItem{ display:flex; align-items:center; gap:10px; padding:10px 12px; border-bottom:1px solid var(--border); cursor:pointer; }
    .cmdItem:hover, .cmdItem.active{ background: rgba(96,165,250,.12); }
    .hamb{ position:fixed; top:10px; left:10px; z-index:70; display:none; }
    @media (max-width:1200px){ .shell{ grid-template-columns:300px 1fr; } .right{ display:none; } }
    @media (max-width:900px){ .hamb{ display:block; } .left{ position:fixed; left:0; top:0; transform:translateX(-100%); transition: transform .25s; z-index:80; width:88vw; max-width:360px; } .left.open{ transform:translateX(0); } .shell{ grid-template-columns:1fr; } .top{ padding-left:48px; } }
    @media print{ .left,.right,.top,.fab,.progress,.hamb{ display:none !important; } .container{ padding:0; } body{ background:white; color:#111; } }
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
  </style>
</head>
<body>
  <div class="progress" id="progress"></div>
  <button class="hamb btn" aria-label="Open menu" onclick="toggleMenu()"><i data-lucide="menu"></i></button>
  <div class="shell">
    <aside class="left" id="leftNav" aria-label="Primary">
      <div class="brand"><i data-lucide="book-open" style="color:var(--brand)"></i><h1>Data Best Practices</h1></div>
      <p class="note">Modern decision‑first framework with bias checks & quick references.</p>
      <div class="search"><i data-lucide="search" aria-hidden="true"></i><input id="q" placeholder="Search topics or content…" oninput="onSearch(this.value)"></div>
      <a class="navlink" data-target="overview" href="#overview"><i data-lucide="home"></i>Framework Overview</a>
      <div class="section">
        <button type="button" aria-expanded="false" aria-controls="nav-phases" onclick="toggleSection(this)"><i data-lucide="trending-up"></i>The Five‑Phase Framework<i class="chev" data-lucide="chevron-right" style="margin-left:auto;"></i></button>
        <nav id="nav-phases" class="subnav">
          <a data-target="phase1" href="#phase1">Phase 1: Frame the Decision</a>
          <a data-target="phase2" href="#phase2">Phase 2: Extract Data</a>
          <a data-target="phase3" href="#phase3">Phase 3: Interpret with Rigor</a>
          <a data-target="phase4" href="#phase4">Phase 4: Bias Detection</a>
          <a data-target="phase5" href="#phase5">Phase 5: Translate to Decisions</a>
        </nav>
      </div>
      <div class="section">
        <button type="button" aria-expanded="false" aria-controls="nav-guides" onclick="toggleSection(this)"><i data-lucide="users"></i>User Level Guidelines<i class="chev" data-lucide="chevron-right" style="margin-left:auto;"></i></button>
        <nav id="nav-guides" class="subnav">
          <a data-target="businessUsers" href="#businessUsers">Business Users & Managers</a>
          <a data-target="analysts" href="#analysts">Analysts & Consultants</a>
          <a data-target="dataPros" href="#dataPros">Data Professionals</a>
        </nav>
      </div>
      <div class="section">
        <button type="button" aria-expanded="false" aria-controls="nav-ref" onclick="toggleSection(this)"><i data-lucide="file-text"></i>Quick Reference<i class="chev" data-lucide="chevron-right" style="margin-left:auto;"></i></button>
        <nav id="nav-ref" class="subnav">
          <a data-target="sampleSize" href="#sampleSize">Sample Size Guide</a>
          <a data-target="biasCheck" href="#biasCheck">Bias Self‑Check</a>
          <a data-target="dosDonts" href="#dosDonts">Do’s & Don’ts</a>
        </nav>
      </div>
      <div class="side-cta">
        <button class="btn" onclick="expandAll()"><i data-lucide="chevron-down"></i>Expand</button>
        <button class="btn ghost" onclick="collapseAll()"><i data-lucide="chevron-right"></i>Collapse</button>
      </div>
      <p class="note" style="padding: 0 18px 24px;">Shortcuts: <span class="kbd">Ctrl/⌘+K</span> command · <span class="kbd">/</span> search · <span class="kbd">t</span> theme · <span class="kbd">[</span>/<span class="kbd">]</span> prev/next</p>
    </aside>
    <section class="center">
      <div class="top" id="topbar">
        <div class="container">
          <div class="topbar">
            <div class="crumbs" id="crumbs"><i data-lucide="bookmark"></i><span>Overview</span></div>
            <div style="display:flex; gap:8px;">
              <button class="btn ghost" onclick="copyLink()" title="Copy link"><i data-lucide="link-2"></i></button>
              <button class="btn ghost" onclick="toggleTheme()" title="Toggle theme"><i id="themeIcon" data-lucide="sun"></i></button>
              <button class="btn ghost" onclick="window.print()" title="Print"><i data-lucide="printer"></i></button>
              <button class="btn" onclick="openCmd()" title="Command (Ctrl/⌘+K)"><i data-lucide="command"></i></button>
            </div>
          </div>
          <div class="hero">
            <div class="heroCard" id="heroCard">
              <div class="heroIcon"><i id="heroIcon" data-lucide="home"></i></div>
              <div>
                <h2 id="heroTitle">Framework Overview</h2>
                <p id="heroTag" class="muted">Start with questions, not data. Let evidence drive decisions.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container main">
        <div id="content" class="content" tabindex="-1"></div>
      </div>
    </section>
    <aside class="right">
      <div class="rail container">
        <div class="panel"><h5>Quick Tips</h5><ul id="tips"></ul></div>
        <div class="panel"><h5>Keyboard</h5>
          <ul style="list-style:none; padding-left:0; margin:0; color:var(--muted)">
            <li><span class="kbd">Ctrl/⌘+K</span> Command</li>
            <li><span class="kbd">/</span> Search</li>
            <li><span class="kbd">t</span> Theme</li>
            <li><span class="kbd">[</span>/<span class="kbd">]</span> Prev/Next</li>
          </ul>
        </div>
      </div>
    </aside>
  </div>
  <div class="fab">
    <button class="btn" onclick="scrollTo({top:0, behavior:'smooth'})" title="Back to top"><i data-lucide="arrow-up"></i></button>
    <button class="btn" onclick="copyLink()" title="Copy link"><i data-lucide="link-2"></i></button>
  </div>
  <div class="cmdk" id="cmdk" role="dialog" aria-modal="true" aria-label="Command palette">
    <div class="cmd" role="document">
      <div class="cmdHead"><i data-lucide="search"></i><input id="cmdInput" placeholder="Jump to any section…" /></div>
      <div class="cmdList" id="cmdList"></div>
    </div>
  </div>
  <script>
    // Icons
    function renderIcons(){ window.lucide && window.lucide.createIcons(); }

    // Theme
    const themeKey='dbp-theme';
    function applyTheme(t){ document.documentElement.setAttribute('data-theme', t); const icon = (t==='light'?'moon':'sun'); document.getElementById('themeIcon').setAttribute('data-lucide', icon); renderIcons(); }
    function toggleTheme(){ const cur=document.documentElement.getAttribute('data-theme')||'dark'; const nxt=cur==='light'?'dark':'light'; localStorage.setItem(themeKey,nxt); applyTheme(nxt); }

    // Mobile menu
    function toggleMenu(){ document.getElementById('leftNav').classList.toggle('open'); }

    // Accordion
    function toggleSection(btn){ const nav=btn.nextElementSibling; const chev=btn.querySelector('.chev'); const exp=btn.getAttribute('aria-expanded')==='true'; btn.setAttribute('aria-expanded',!exp); nav.style.display=exp?'none':'block'; if(chev) chev.setAttribute('data-lucide', exp?'chevron-right':'chevron-down'); renderIcons(); }
    function expandAll(){ document.querySelectorAll('.section > button').forEach(b=>{ if(b.getAttribute('aria-expanded')==='false') toggleSection(b); }); }
    function collapseAll(){ document.querySelectorAll('.section > button').forEach(b=>{ if(b.getAttribute('aria-expanded')==='true') toggleSection(b); }); }

    // Progress bar
    function onScroll(){ const doc=document.scrollingElement; const pct=(doc.scrollTop)/(doc.scrollHeight-doc.clientHeight)*100; document.getElementById('progress').style.width=pct+'%'; }
    document.addEventListener('scroll', onScroll, {passive:true});

    // Command palette
    const cmdk=document.getElementById('cmdk'); const cmdInput=document.getElementById('cmdInput'); const cmdList=document.getElementById('cmdList');
    function openCmd(){ cmdk.classList.add('open'); cmdInput.value=''; renderCmd(''); cmdInput.focus(); }
    function closeCmd(){ cmdk.classList.remove('open'); }
    cmdk.addEventListener('click',(e)=>{ if(e.target===cmdk) closeCmd(); });
    cmdInput.addEventListener('input',()=> renderCmd(cmdInput.value));

    document.addEventListener('keydown',(e)=>{
      if((e.key.toLowerCase()==='k'&&(e.metaKey||e.ctrlKey))){ e.preventDefault(); openCmd(); }
      if(e.key==='Escape'&&cmdk.classList.contains('open')) closeCmd();
      if(e.key.toLowerCase()==='t'&&!cmdk.classList.contains('open')) toggleTheme();
      if(e.key==='/'){ const a=document.activeElement; if(!a||a.tagName!=='INPUT'){ e.preventDefault(); document.getElementById('q').focus(); } }
      if(e.key==='['){ e.preventDefault(); stepNav(-1); }
      if(e.key===']'){ e.preventDefault(); stepNav(1); }
    });

    function renderCmd(q){ const items=navItems().map(it=>({key:it.getAttribute('data-target'), label: it.textContent.trim()})); const t=(q||'').toLowerCase(); const filtered=items.filter(x=>!t||x.label.toLowerCase().includes(t)); cmdList.innerHTML=''; filtered.forEach(x=>{ const row=document.createElement('div'); row.className='cmdItem'; row.tabIndex=0; row.innerHTML=`<i data-lucide="hash"></i><div>${x.label}</div>`; row.addEventListener('click',()=>{ navigateTo(x.key); closeCmd(); }); row.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ navigateTo(x.key); closeCmd(); } }); cmdList.appendChild(row); }); renderIcons(); }

    // Search
    function onSearch(text){ const t=(text||'').toLowerCase(); document.querySelectorAll('.navlink, .subnav a').forEach(a=>{ a.style.display=!t||a.textContent.toLowerCase().includes(t)?'':'none'; }); highlight(t); }
    function highlight(term){ const root=document.getElementById('content'); root.querySelectorAll('mark').forEach(m=>{ const p=m.parentNode; p.replaceChild(document.createTextNode(m.textContent), m); p.normalize(); }); if(!term) return; const w=document.createTreeWalker(root, NodeFilter.SHOW_TEXT); const nodes=[]; while(w.nextNode()) nodes.push(w.currentNode); const re=new RegExp(term.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),'gi'); nodes.forEach(n=>{ const text=n.nodeValue; if(!text.trim()) return; const frag=document.createDocumentFragment(); let last=0, m; while((m=re.exec(text))){ if(m.index>last) frag.appendChild(document.createTextNode(text.slice(last,m.index))); const mark=document.createElement('mark'); mark.textContent=m[0]; frag.appendChild(mark); last=m.index+m[0].length; } if(last<text.length) frag.appendChild(document.createTextNode(text.slice(last))); if(frag.childNodes.length) n.parentNode.replaceChild(frag,n); }); }

    // Content registry (using your v3 content with specialists + audience clarification)
    const views={
      overview: html(`
        <div class="card">
          <p><strong>Start with questions, not data.</strong> Define what decision you're making, identify what could bias your thinking, then gather and interpret evidence. This approach prevents common mistakes by forcing clear questions, hypotheses, and thresholds up front—so we collect the right evidence and let that evidence drive (and, when needed, overturn) our decisions.</p>
          <p>Rather than jumping straight to dashboards, this framework ensures less bias, maximizes accuracy, and leads to better operational outcomes.</p>
        </div>
        <div class="card">
          <h3>Audience</h3>
          <p><strong>For Business Users & Managers</strong><br>
          Primary focus is on Phases 1, 3, and 5—framing questions, interpreting insights, and making decisions.<br>
          However, you should still understand and validate Phases 2 and 4 at a high level: confirm data sources are certified and bias checks are considered before acting.</p>
          <p><strong>For Analysts & Consultants</strong><br>
          Engage deeply with all five phases to ensure rigor throughout the decision process.</p>
        </div>
        <div class="card">
          <h3>The Five Phases at a Glance</h3>
          <ol>
            <li><strong>Frame the Decision</strong>: Define SMART (Specific · Measurable · Action‑oriented · Relevant · Time‑bound) questions before touching data</li>
            <li><strong>Extract Data Systematically</strong>: Use certified datasets and consistent methods</li>
            <li><strong>Interpret with Rigor</strong>: Apply context, statistical significance, and seasonality</li>
            <li><strong>Apply Bias Detection</strong>: Actively identify and mitigate cognitive biases</li>
            <li><strong>Translate to Decisions</strong>: Document rationale and monitoring plans</li>
          </ol>
        </div>
      `),
      phase1: html(`
        <div class="callout"><strong>Why it matters:</strong> Poor framing leads to wasted analysis, misleading conclusions, and bad decisions. Invest <strong>10–15 minutes</strong> here to save hours later.</div>
        <div class="card">
          <h3>SMART Questions Framework</h3>
          <h4>Specific</h4>
          <ul>
            <li>Define exactly what you're trying to decide, including:
              <ul>
                <li>The metric that matters (e.g., TAT)</li>
                <li>The threshold that matters (e.g., 30 days)</li>
                <li>The timeframe (e.g., Q4)</li>
                <li>The standard (e.g., 95%)</li>
              </ul>
            </li>
            <li><span class="danger">Too vague:</span> “Are we staffed appropriately?”</li>
            <li><span class="ok">✓ Better:</span> “Do we have sufficient <strong>specialists</strong> to maintain X% claims processed within X days given Q4 volume patterns?”</li>
          </ul>
          <h4>Measurable</h4>
          <ul>
            <li>Identify specific metrics before analysis:
              <ul>
                <li>Current claims per <strong>specialist</strong></li>
                <li>Average handling time</li>
                <li>Queue depth</li>
                <li>TAT performance</li>
                <li><strong>Specialist</strong> utilization rate</li>
              </ul>
            </li>
            <li><em>Write these down to prevent cherry‑picking favorable metrics later.</em></li>
          </ul>
          <h4>Action‑Oriented</h4>
          <p>Connect your question to a decision with consequences: “Will we hire additional <strong>specialists</strong>, redistribute workload, or maintain current staffing?” <span class="danger">If no action will result, question whether the analysis is necessary.</span></p>
          <h4>Relevant</h4>
          <ul>
            <li>Ensure the question matters to business outcomes. Document:
              <ul>
                <li>Why this question matters now</li>
                <li>Who needs the answer</li>
                <li>Impact on TAT, customer satisfaction, costs, quality</li>
              </ul>
            </li>
          </ul>
          <h4>Time‑Bound</h4>
          <ul>
            <li>Define comparison periods explicitly:
              <ul>
                <li><span class="danger"></span> “Compare October 2025 to September 2025” (risks seasonality errors)</li>
                <li><span class="ok">✓</span> “Compare Q3 2025 to Q3 2024 and Q3 2023” (accounts for seasonal patterns)</li>
              </ul>
            </li>
          </ul>
        </div>
        <div class="card">
          <h3>Document Before Analysis</h3>
          <h4>Hypotheses & Assumptions</h4>
          <p>Write down what you expect to find and why: “I expect Q4 claim volume to increase 15–20% based on historical patterns, which would require 3–4 additional <strong>specialists</strong> to maintain TAT.”</p>
          <h4>Potential Biases</h4>
          <ul>
            <li>Anchoring: on last year's headcount</li>
            <li>Recency: from recent difficult weeks</li>
            <li>Availability: if challenging claims are top of mind</li>
            <li>Confirmation: toward standard processes</li>
            <li>Sunflower: where junior team members defer to senior leaders</li>
          </ul>
        </div>
      `),
      phase2: html(`
        <div class="card">
          <h2 style="margin:0 0 6px; font-size:22px">Phase 2: Extract Data Systematically</h2>
          <p><strong>Key Principle:</strong> Always start with certified, governed datasets rather than creating custom extractions. These have been validated for accuracy and include proper quality controls.</p>
        </div>
        <div class="card">
          <h3>Best Practices</h3>
          <h4>✓ Use Consistent Time Periods</h4>
          <ul>
            <li><strong>Year‑over‑Year Comparisons:</strong> Always compare identical periods (e.g., Q3 2025 vs Q3 2024) to account for seasonality.</li>
            <li><strong>Minimum Analysis Period:</strong> Never analyze less than one complete month. Weekly comparisons are unreliable due to within‑month patterns.</li>
            <li><strong>Seasonal Adjustments:</strong> For trending, use 12‑month moving averages or seasonal indices maintained by your data team.</li>
          </ul>
          <h4> Data Extraction Checklist</h4>
          <ul>
            <li>Verified most recent data refresh timestamp</li>
            <li>Documented exact filters applied</li>
            <li>Recorded sample size</li>
            <li>Noted data quality warnings</li>
            <li>Saved extraction parameters</li>
          </ul>
          <h4>Custom View Guidelines</h4>
          <ul>
            <li><span class="ok">✓</span> Limit to <strong>2–3 visualizations</strong> per dashboard (more creates cognitive overload)</li>
            <li><span class="danger"></span> Use filters appropriately (each filter requires a query; excessive filtering degrades performance)</li>
            <li><span class="danger"></span> Mind the data volume (dashboards with &gt;1M data points will load slowly)</li>
          </ul>
        </div>
        <div class="card">
          <h3>Common Extraction Errors</h3>
          <ul>
            <li><strong>Mixing Date Fields:</strong> Be explicit about claim submission date vs triage date</li>
            <li><strong>Ignoring Claim Status:</strong> Including pending claims or marked-up-error in calculation can distort analysis </li>
            <li><strong>Overlooking Client Rules:</strong> Client implementations/customizations may affect aggregate metrics</li>
          </ul>
        </div>
      `),
      phase3: html(`
        <div class="card">
          <h2 style="margin:0 0 6px; font-size:22px">Phase 3: Interpret Data with Rigor</h2>
          <p><strong>Core Goal:</strong> Not to confirm what you expected but to understand what is true. Three principles guide sound interpretation.</p>
        </div>
        <div class="card">
          <h3>Principle 1: Context is Mandatory</h3>
          <ul>
            <li><strong>Historical Context:</strong> “AHT increased 10% from 28 to 30.8 minutes, the highest level since Q1 2024.”</li>
            <li><strong>Benchmark Context:</strong> “AHT of 30.8 minutes exceeds our 28‑minute target but remains within industry standard of 32 minutes.”</li>
            <li><strong>Causal Context:</strong> “AHT increase coincides with implementation of three new clients requiring complex medical records review.”</li>
            <li><strong>Comparative Context:</strong> “AHT increased 10% while claim complexity increased 15%.”</li>
          </ul>
        </div>
        <div class="card">
          <h3>Principle 2: Statistical vs Practical Significance </h3>
          <h4>Sample Size Minimums by Metric</h4>
          <table class="table">
            <thead><tr><th>Metric Type</th><th>Minimum Sample</th></tr></thead>
            <tbody>
              <tr><td>Claims processing (TAT, AHT)</td><td># claims/<strong>specialist</strong>/period</td></tr>
              <tr><td>Client performance</td><td># claims/month or # months data</td></tr>
              <tr><td>A/B testing</td><td># claims per variant</td></tr>
              <tr><td>Return‑to‑work metrics</td><td># completed episodes</td></tr>
            </tbody>
          </table>
          <p><em>When sample sizes are below minimums:</em> Report descriptively only. Use language like “Early indicators suggest…” and flag that additional data is needed.</p>
          <h4>Practical Significance Thresholds</h4>
          <p><strong>Staffing & Capacity (Example)</strong></p>
          <ul>
            <li>Claims/<strong>specialist</strong> variance: ±5% normal, 10%+ requires action</li>
            <li>Utilization changes: ±3% may be noise, 5%+ warrants investigation</li>
            <li>Turnover: 10%+ annualized rate signals problem</li>
          </ul>
          <p><strong>Process Performance (Example)</strong></p>
          <ul>
            <li>TAT: ±1 day may not be meaningful, 2+ days requires investigation</li>
            <li>AHT: ±2 minutes typical, 10%+ change indicates process shift</li>
            <li>Accuracy: Even 1–2% change can be significant given 95%+ baseline</li>
          </ul>
          <p><strong>Financial Metrics (Example)</strong></p>
          <ul>
            <li>Benefit payment variance: ±2% normal, 5%+ requires validation</li>
            <li>Cost per claim: ±$5 likely normal, $10+ warrants analysis</li>
          </ul>
        </div>
        <div class="card">
          <h3>Principle 3: Account for Seasonality (Trend Examples Below)</h3>
          <ul style="display:flex; flex-wrap:wrap; gap:8px; list-style:none; padding-left:0;">
            <li class="kbd">January — New year surge</li>
            <li class="kbd">Mar–Apr — Spring normalization</li>
            <li class="kbd">May–Jun — Baseline</li>
            <li class="kbd">Jul–Aug — Summer uptick</li>
            <li class="kbd">Sep–Oct — Return to baseline</li>
            <li class="kbd">November — Holiday uptick</li>
            <li class="kbd">December — Year‑end low</li>
          </ul>
          <h4> Red Flags</h4>
          <ul>
            <li>Comparing consecutive months without mentioning seasonality</li>
            <li>Declaring “improvement” or “decline” based on a single month</li>
            <li>Using month‑to‑date metrics before month‑end without normalizing</li>
            <li>Not accounting for expected seasonal patterns in your organization</li>
          </ul>
        </div>
      `),
      phase4: html(`
        <div class="card">
          <h2 style="margin:0 0 6px; font-size:22px">Phase 4: Apply Bias Detection and Mitigation</h2>
          <p><strong>Critical Checkpoint:</strong> Use this checklist for any significant decision or client communication to prevent cognitive biases from undermining your analysis.</p>
        </div>
        <div class="card">
          <h3> Cherry‑Picking Detection</h3>
          <ul>
            <li>Did I examine all relevant time periods or only favorable ones?</li>
            <li>Am I reporting all key metrics or only positive performance?</li>
            <li>Have I included data that contradicts my hypothesis?</li>
            <li>Would I reach the same conclusion with the full dataset?</li>
          </ul>
          <p><strong>Example:</strong> <span class="danger">Wrong:</span> “Q3 accuracy rate of 97.2% looks strong.” <span class="ok">Honest:</span> “Declining accuracy trend from 97.8% (Q1) to 96.9% (Q4), with Q3 at 97.2%.”</p>
        </div>
        <div class="card">
          <h3> Confirmation Bias Detection</h3>
          <ul>
            <li>Did I define my hypothesis before seeing the data?</li>
            <li>Have I actively sought disconfirming evidence?</li>
            <li>Have I considered alternative explanations?</li>
            <li>Would I accept this conclusion if it contradicted my belief?</li>
          </ul>
          <p><strong>Mitigation:</strong> Document alternative hypotheses (training effectiveness, reduction in claim complexity, system improvements, selection bias, random variation) and evaluate each systematically.</p>
        </div>
        <div class="card">
          <h3> Sample Size Bias Detection</h3>
          <ul>
            <li>Does my sample meet minimum thresholds?</li>
            <li>Am I analyzing subgroups with insufficient sample?</li>
            <li>Have I calculated confidence intervals?</li>
            <li>Am I comparing groups with vastly different sizes?</li>
          </ul>
          <p><strong>Example:</strong> Client A: 2,400 claims (96.5%); Client B: 45 claims (100%). <span class="danger">⚠️</span> Client B's confidence interval is ±13% (true accuracy could be 87–100%). Statistically indistinguishable.</p>
        </div>
        <div class="card">
          <h3> Recency Bias Detection</h3>
          <ul>
            <li>Am I overweighting recent experiences?</li>
            <li>Am I extrapolating short‑term fluctuations?</li>
            <li>Have I examined sufficient historical context?</li>
            <li>Could recent events be outliers?</li>
          </ul>
          <p><strong>Signal vs Noise:</strong> 1 week/month poor performance = Noise; 3 consecutive months exceeding thresholds = Signal.</p>
        </div>
        <div class="card">
          <h3> Anchoring Bias Detection</h3>
          <ul>
            <li>Am I overly influenced by historical baselines?</li>
            <li>Have I questioned whether historical performance is right?</li>
            <li>Am I resistant to significantly different conclusions?</li>
            <li>Have I considered external benchmarks?</li>
          </ul>
        </div>
      `),
      phase5: html(`
        <div class="card">
          <h2 style="margin:0 0 6px; font-size:22px">Phase 5: Translate Insights into Decisions</h2>
          <p><strong>Decision Documentation Framework:</strong> Complete this before any significant operational decision. It creates accountability, enables learning from outcomes, and ensures rigorous thinking.</p>
        </div>
        <div class="card">
          <h3>Decision Documentation Template</h3>
          <h4>Decision Summary</h4>
          <ul>
            <li>Decision:</li>
            <li>Decision‑Maker:</li>
            <li>Date:</li>
            <li>Implementation Timeline:</li>
          </ul>
          <h4>Analysis Foundation</h4>
          <h4>Findings</h4>
          <p>Confidence Level: <strong>High</strong> / <strong>Medium</strong> / <strong>Low</strong></p>
          <h4>Decision Rationale</h4>
          <h4>Risks and Monitoring</h4>
        </div>
        <div class="card">
          <h3>Example: Staffing Addition Decision</h3>
          <ul>
            <li><strong>Decision:</strong> Add 2 FTE <strong>specialists</strong> to the STD team effective December 1, 2025</li>
            <li><strong>Primary Finding:</strong> Capacity insufficient for sustained growth; TAT trending toward SLA threshold</li>
            <li><strong>Evidence:</strong>
              <ul>
                <li>Claims per <strong>specialist</strong>: 195 → 212 (8.7% ↑)</li>
                <li>Monthly volume: 3,800 → 4,200+</li>
                <li>TAT: 23.2 → 26.8 days (near 30‑day threshold)</li>
                <li><strong>Specialist</strong> utilization: 94% (no buffer)</li>
              </ul>
            </li>
            <li><strong>Expected Impact:</strong> TAT back to 23–24 days by Feb 2026; sustain ≥95% within 30‑day standard through Q1 surge</li>
          </ul>
        </div>
      `),
      businessUsers: html(`
        <div class="card">
          <h2 style="margin:0 0 6px; font-size:22px">Guidelines for Business Users & Managers</h2>
          <p><strong>Your Primary Role:</strong> Consume reports and dashboards to inform day‑to‑day operational decisions. Interpret accurately and know when to escalate.</p>
        </div>
        <div class="card">
          <h3>Core Competencies</h3>
          <ul>
            <li> Reading Visualizations — understand chart types and insight extraction</li>
            <li> Recognizing Warning Signs — know when something “looks wrong”</li>
            <li> Asking Good Questions — frame questions analysts can translate to data</li>
            <li> Understanding Context — metrics, benchmarks, and comparisons</li>
          </ul>
        </div>
        <div class="card">
          <h3>When to Self‑Serve vs Escalate</h3>
          <h4>✓ Self‑Serve</h4>
          <ul>
            <li>Routine KPI monitoring</li>
            <li>Compare to targets or prior periods</li>
            <li>Basic filtering in dashboards</li>
            <li>Standard report generation</li>
          </ul>
          <h4> Escalate When</h4>
          <ul>
            <li>Need custom analysis</li>
            <li>Unsure about sample sizes</li>
            <li>Need statistical validation</li>
            <li>Resource‑impacting decisions</li>
            <li>Inconsistent or conflicting metrics</li>
            <li>Distinguishing variation vs changes</li>
          </ul>
        </div>
        <div class="card">
          <h3>Red Flags</h3>
          <ul>
            <li> Small samples (&lt; 50–100)</li>
            <li> Surprising/counterintuitive findings</li>
            <li> High‑stakes decisions (client, SLA)</li>
            <li> Conflicting metrics</li>
            <li> Data quality concerns</li>
          </ul>
        </div>
      `),
      analysts: html(`
        <div class="card">
          <h2 style="margin:0 0 6px; font-size:22px">Guidelines for Analysts & Consultants</h2>
          <p><strong>Your Primary Role:</strong> Conduct analyses, support business questions, design reports, and ensure rigor in team decisions.</p>
        </div>
        <div class="card">
          <h3>Advanced Competencies</h3>
          <ul>
            <li> Statistical reasoning (CI, tests, SPC)</li>
            <li> Data modeling (relationships, performance, quality)</li>
            <li> Bias detection & mitigation</li>
            <li> Communication: translate, recommend, document</li>
          </ul>
        </div>
        <div class="card">
          <h3>Workflow</h3>
          <h4> Before</h4>
          <ul>
            <li>Understand decision context</li>
            <li>Document question, success criteria, usage</li>
            <li>Identify likely biases</li>
            <li>Plan data sources & validation</li>
          </ul>
          <h4> During</h4>
          <ul>
            <li>Follow the Five‑Phase Framework</li>
            <li>Document assumptions & decisions</li>
            <li>Seek disconfirming evidence</li>
            <li>Peer review interpretations</li>
          </ul>
          <h4> Presenting</h4>
          <ul>
            <li>Lead with implications</li>
            <li>Show uncertainty (CIs)</li>
            <li>Actionable recommendations</li>
            <li>Anticipate alternatives</li>
            <li>Executive summary + appendix</li>
          </ul>
        </div>
        <div class="card">
          <h3>AI Decision‑Assist Monitoring</h3>
          <ul>
            <li>Model vs human vs ground truth</li>
            <li>Outcome parity across cohorts</li>
            <li>Confidence calibration</li>
            <li>Override reasons & impact</li>
            <li>Performance drift</li>
            <li>Explainability</li>
          </ul>
        </div>
      `),
      dataPros: html(`
        <div class="card">
          <h2 style="margin:0 0 6px; font-size:22px">Guidelines for Data‑Savvy Professionals</h2>
          <p><strong>Your Primary Role:</strong> Architecture, advanced analytics, governance, and enabling self‑service at scale.</p>
        </div>
        <div class="card">
          <h3>Strategic Responsibilities</h3>
          <h4> Governance & Standards</h4>
          <ul>
            <li>Certified datasets with lineage</li>
            <li>Data quality rules & naming conventions</li>
            <li>Semantic layer for safe self‑service</li>
            <li>Business glossary</li>
          </ul>
          <h4> Platform Optimization</h4>
          <ul>
            <li>Monitor BI performance; optimize queries</li>
            <li>Model design: flexibility × performance</li>
            <li>Incremental refresh</li>
            <li>Guardrails for performance/quality</li>
          </ul>
          <h4> Advanced Analytics Enablement</h4>
          <ul>
            <li>Forecasting & capacity models</li>
            <li>SPC for quality metrics</li>
            <li>Anomaly detection & alerting</li>
            <li>Embedded methodology guidance</li>
          </ul>
          <h4> Bias Mitigation by Design</h4>
          <ul>
            <li>Bias checks in templates</li>
            <li>Visualizations with YoY defaults & CIs</li>
            <li>Alerts for small samples/unusual patterns</li>
            <li>Workflows enforcing the Five‑Phase Framework</li>
          </ul>
        </div>
        <div class="card">
          <h3>Implementation Priorities</h3>
          <ol>
            <li><strong>Make the right thing the easy thing</strong> — YoY defaults, auto CIs, surface data quality warnings</li>
            <li><strong>Build guardrails, not roadblocks</strong> — flexibility with safe defaults, alternatives for risky patterns</li>
            <li><strong>Enable learning through doing</strong> — contextual help, celebrate good examples</li>
            <li><strong>Monitor & optimize</strong> — usage analytics, pain points, iteration</li>
          </ol>
        </div>
      `),
      sampleSize: html(`
        <div class="card">
          <h2 style="margin:0 0 6px; font-size:22px">Sample Size Quick Reference</h2>
          <p><strong>Core Principles:</strong> Larger samples = more confidence. Smaller samples = more uncertainty. Higher stakes require larger samples.</p>
        </div>
        <div class="card">
          <h3>When Sample Size is Insufficient</h3>
          <h4> Don't</h4>
          <ul>
            <li>Draw definitive conclusions</li>
            <li>Make resource decisions</li>
            <li>Report to clients as fact</li>
            <li>Compare groups with vastly different sizes</li>
          </ul>
          <h4>✓ Do</h4>
          <ul>
            <li>Report descriptively only</li>
            <li>Use language like “Early indicators…”</li>
            <li>Calculate/report confidence intervals</li>
            <li>Flag need for additional data</li>
          </ul>
        </div>
      `),
      biasCheck: html(`
        <div class="card">
          <h2 style="margin:0 0 6px; font-size:22px">Bias Self‑Check</h2>
          <p>Before finalizing any analysis or recommendation, ask yourself:</p>
          <ol>
            <li><strong>Cherry‑picking</strong> — Am I showing all relevant data or only favorable metrics?</li>
            <li><strong>Confirmation</strong> — Did I define my hypothesis before seeing data? Sought contradicting evidence?</li>
            <li><strong>Sample size</strong> — Is my sample large enough for this conclusion?</li>
            <li><strong>Recency</strong> — Overweighting recent events? Undervaluing history?</li>
            <li><strong>Anchoring</strong> — Attached to historical baselines that may no longer apply?</li>
            <li><strong>Seasonality</strong> — Compared appropriate periods and considered seasonal patterns?</li>
          </ol>
          <div class="callout"><strong>Important:</strong> If you can't confidently answer “yes” to all six, consult an analyst before proceeding.</div>
        </div>
      `),
      dosDonts: html(`
        <div class="card">
          <h2 style="margin:0 0 6px; font-size:22px">BI Tool Do's and Don'ts</h2>
          <p><em>Guidelines to ensure accurate, efficient, reproducible analysis.</em></p>
        </div>
        <div class="card">
          <h3>✓ DO</h3>
          <ul>
            <li><strong>Document filters</strong> — date ranges, segments, other filters</li>
            <li><strong>Check refresh timestamp</strong> — use most recent data</li>
            <li><strong>Save extraction parameters</strong> — reproducibility</li>
            <li><strong>Use YoY comparisons</strong> — avoid seasonality traps</li>
            <li><strong>Limit to 2–3 visualizations</strong> per dashboard</li>
            <li><strong>Apply glossary definitions</strong> — consistency</li>
          </ul>
          <h3> DON'T</h3>
          <ul>
            <li>Build custom extractions solo</li>
            <li>Mix date fields (submission vs decision)</li>
            <li>Compare non‑equivalent periods (MoM without seasonal adj.)</li>
            <li>Include pending claims in accuracy</li>
            <li>Only analyze adjudicated claims for quality</li>
            <li>Load &gt;1M points per dashboard</li>
            <li>Use excessive filters (each = query)</li>
          </ul>
        </div>
      `)
    };

    // Right-rail tips (same as before)
    const tipsByView={ overview:['How to use: Pick your role, then navigate the Five Phases.','Default comparisons: year‑over‑year beats month‑to‑month.','Write hypotheses before opening a dashboard.'], phase1:['SMART: Specific · Measurable · Action‑oriented · Relevant · Time‑bound','If no action follows from the answer, reframe the question.','List potential biases before you start (anchoring, recency, availability…).'], phase2:['Prefer certified datasets over ad‑hoc pulls.','Never analyze less than a full month unless statistically justified.','Document filters and refresh timestamps.'], phase3:['Always add historical, benchmark, and causal context.','Report CIs when samples are small.','Separate statistical from practical significance.'], phase4:['Actively seek disconfirming evidence.','Check sample sizes before asserting differences.','Visualize time series to avoid recency traps.'], phase5:['Write the decision like a headline; defend with evidence.','Document monitoring plan and leading indicators.','Capture expected impact and timeline upfront.'], businessUsers:['Self‑serve for routine KPIs; escalate for custom or high‑stakes.','Beware MoM comparisons without seasonality.','Ask for confidence intervals on surprising results.'], analysts:['Lead with business implications, not methods.','Track override outcomes for AI recommendations.','Peer review interpretations before publishing.'], dataPros:['Guardrails > roadblocks: make the right thing the easy thing.','Instrument usage and iterate on pain points.','Bake bias checks into templates and semantic models.'], sampleSize:['High‑stakes ⇒ larger samples.','Use CIs and descriptive language when small.','Avoid comparing groups with very different n.'], biasCheck:['If you can’t say “yes” to all six, pause and consult.','Write your hypothesis before viewing data.','YoY > MoM for pattern detection.'], dosDonts:['Save parameters for reproducibility.','Limit visuals to reduce cognitive load.','Avoid mixing non‑equivalent periods.'] };

    const heroMeta={ overview:{icon:'home', title:'Framework Overview', tag:'Start with questions, not data — let disciplined evidence drive decisions.'}, phase1:{icon:'target', title:'Phase 1 · Frame the Decision', tag:'SMART questions and bias awareness set the path to truth.'}, phase2:{icon:'database', title:'Phase 2 · Extract Data', tag:'Use certified sources, consistent periods, and documented filters.'}, phase3:{icon:'line-chart', title:'Phase 3 · Interpret with Rigor', tag:'Context, significance, and seasonality — always together.'}, phase4:{icon:'shield-check', title:'Phase 4 · Bias Detection', tag:'Seek disconfirming evidence and challenge anchors.'}, phase5:{icon:'file-check-2', title:'Phase 5 · Decisions', tag:'Write the decision, rationale, risks, and monitoring plan.'}, businessUsers:{icon:'briefcase', title:'Business Users & Managers', tag:'Know when to self‑serve and when to escalate.'}, analysts:{icon:'beaker', title:'Analysts & Consultants', tag:'Analysis craft, communication, and bias‑aware workflows.'}, dataPros:{icon:'settings-2', title:'Data Professionals', tag:'Governance, performance, and bias‑resistant defaults.'}, sampleSize:{icon:'ruler', title:'Sample Size', tag:'Confidence scales with n — mind your intervals.'}, biasCheck:{icon:'search-check', title:'Bias Self‑Check', tag:'A six‑point pause before you hit send.'}, dosDonts:{icon:'list-checks', title:"Do's & Don'ts", tag:'Clarity, consistency, performance.'} };

    function navItems(){ return Array.from(document.querySelectorAll('[data-target]')); }
    function setActive(key){ document.querySelectorAll('[data-target]').forEach(a=> a.classList.remove('active')); const el=document.querySelector(`[data-target="${key}"]`); if(el){ el.classList.add('active'); ensureOpen(el); } }
    function ensureOpen(link){ const nav=link.closest('.subnav'); if(nav){ const btn=nav.previousElementSibling; if(btn.getAttribute('aria-expanded')==='false') toggleSection(btn); } }

    function setHero(key){ const meta=heroMeta[key]||heroMeta['overview']; document.getElementById('heroTitle').textContent=meta.title; document.getElementById('heroTag').textContent=meta.tag; const hi=document.getElementById('heroIcon'); hi.setAttribute('data-lucide', meta.icon); renderIcons(); document.getElementById('crumbs').lastElementChild.textContent=meta.title; }

    function setTips(key){ const tips=tipsByView[key]||tipsByView['overview']; const ul=document.getElementById('tips'); ul.innerHTML=''; tips.forEach(t=>{ const li=document.createElement('li'); li.textContent=t; ul.appendChild(li); }); }

    // Precise scroll alignment so the first meaningful element is visible under the sticky header
    function scrollToContentTop(){
      const topbar = document.getElementById('topbar');
      const offset = (topbar?.offsetHeight || 0) + 8; // add a small breathing space
      const root = document.getElementById('content');
      const target = root.querySelector('.callout') || root.querySelector('.card') || root; // prefer callout if present
      const y = target.getBoundingClientRect().top + window.pageYOffset - offset;
      window.scrollTo({ top: Math.max(0, y), behavior: 'auto' });
    }

    function renderView(key){
      const content=document.getElementById('content');
      content.innerHTML='';
      const section=document.createElement('section'); section.setAttribute('role','region'); section.className='fade'; section.append(views[key]||views['overview']);
      content.append(section);
      setHero(key); setTips(key); setActive(key);
      if(history.pushState){ history.pushState(null,'','#'+key); } else { location.hash='#'+key; }

      // Accessibility focus first, then perform final scroll alignment after layout settles
      content.focus(); renderIcons();
      const q=document.getElementById('q'); if(q&&q.value) highlight(q.value.toLowerCase());
      // double rAF ensures DOM + fonts settle before scrolling
      requestAnimationFrame(()=>{ requestAnimationFrame(scrollToContentTop); });
    }

    function navigateTo(key){ renderView(key); }
    function linearList(){ return navItems().filter(el=> el.offsetParent!==null); }
    function currentKey(){ return (location.hash||'#overview').slice(1); }
    function stepNav(dir){ const list=linearList(); const key=currentKey(); const idx=list.findIndex(x=> x.getAttribute('data-target')===key); const next=list[Math.max(0,Math.min(list.length-1,idx+dir))]; if(next) navigateTo(next.getAttribute('data-target')); }

    function copyLink(){ const url=location.origin+location.pathname+location.search+location.hash; navigator.clipboard?.writeText(url).then(()=> toast('Link copied')).catch(()=>{}); }
    function toast(msg){ const t=document.createElement('div'); t.textContent=msg; Object.assign(t.style,{position:'fixed',bottom:'18px',right:'18px',background:'rgba(2,6,23,.85)',color:'#fff',padding:'8px 12px',border:'1px solid var(--border)',borderRadius:'10px',boxShadow:'var(--shadow-md)',zIndex:99}); document.body.appendChild(t); setTimeout(()=>{ t.style.transition='opacity .25s'; t.style.opacity='0'; setTimeout(()=> t.remove(),300); },900); }
    function html(markup){ const div=document.createElement('div'); div.innerHTML=markup.trim(); return div.firstChild?div:div; }

    function wireNav(){ navItems().forEach(el=> el.addEventListener('click',(e)=>{ e.preventDefault(); navigateTo(el.getAttribute('data-target')); document.getElementById('leftNav').classList.remove('open'); })); }

    function init(){ const saved=localStorage.getItem(themeKey); applyTheme(saved||'dark'); wireNav(); renderIcons(); const initial=(location.hash||'#overview').slice(1); navigateTo(initial in views ? initial : 'overview'); }
    window.addEventListener('hashchange', ()=>{ const k=(location.hash||'#overview').replace('#',''); if(k in views) navigateTo(k); });
    init();
  </script>
</body>
</html>
